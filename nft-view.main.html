<html>

    <head>

        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">
        <meta name="robots" content="noindex,nofollow,noarchive">
        <meta name="twitter:card" content="summary" />
        <meta property="og:title" content="WebAR" />
        <meta property="og:description" content="標準ブラウザからARが見られます。" />
        <meta property="og:image" content="asset/share.png" />
        <meta name="apple-mobile-web-app-capable" content="yes">

        <title>ＡＲ</title>

<!--        <link rel="stylesheet" href="css/ar-view.css">-->
        <link rel="stylesheet" href="css/nft-view.css">

        <script type="text/javascript" src="js/ar.main.js"></script>
        <script type="text/javascript" src="js/nft/aframe-master.min.js"></script>
        <script type="text/javascript" src='js/nft/aframe-ar-nft.js'></script>
        <script type="text/javascript" src="js/camera.swich.js"></script>
        <script type="text/javascript" src="js/ar-video.js"></script>

    </head>

    <body>

        <div class="arjs-loader">
            <div>データ読み込み中<br>しばらくお待ちください...</div>
        </div>

<!--        <div class="switch">
            <a id="swMarker" class="swItem"><img src="asset/marker-t.png" width="30"></a>
            <a id="swPreview" class="swItem"><img src="asset/preview-t.png" width="30"></a>
        </div>-->

        <img class="scrshot" id="scrshot" src="asset/scrshot-w.png" />

        <img class="ar-up" id="swUp" src="asset/up-w.png" style="display: inline" />
        <img class="ar-down" id="swDown" src="asset/down-w.png" style="display: inline" />

        <img id="swAngle" class="ar-angle" src="asset/angle-w.png" style="display: inline" />
        <img id="swParallel" class="ar-parallel" src="asset/parallel-w.png" style="display: inline" />

        <a-scene id="ar-scene" vr-mode-ui="enabled: false;" renderer="logarithmicDepthBuffer: true;" embedded arjs="trackingMethod: best; sourceType: webcam; debugUIEnabled: false;">

            <a-nft videohandler type="nft" id="ar-nft" url="" smooth="true" smoothCount="10" smoothTolerance="0.01" smoothThreshold="5">
                
                <a-entity id="ar-gltf" gltf-model="" scale="10 10 10" position="0 0 0" rotation="-45 0 0"></a-entity>
                
            </a-nft>

            <a-camera-static />

        </a-scene>

        <script>
            getNftImage();
            getNftObject();
        </script>
        
<!--        <script>

            var nft = document.getElementById("ar-gltf");
            var anglebtn = document.querySelector('#swAngle');
            var parallelbtn = document.querySelector('#swParallel');

            var xyz = nft.getBoundingClientRect();
            var y = xyz.top;

            // ↓ 上下移動ボタン押下
            var upbtn = document.getElementById('swUp');

            upbtn.addEventListener('click', function () {
                y += 0.2;
                self.wrap.setAttribute('position', AFRAME.utils.coordinates.stringify(wrapPos));
            });

            var downbtn = document.getElementById('swDown');

            downbtn.addEventListener('click', function () {
                wrapPos.y -= 0.2;
                self.wrap.setAttribute('position', AFRAME.utils.coordinates.stringify(wrapPos));
            });
            // ↑ 

            // ↓ UPボタン長押し
            var bUP = document.querySelector('#swUp');
            var bDOWN = document.querySelector('#swDown');
            var eventStart = 'touchstart';
            var eventEnd = 'touchend';
            var eventLeave = 'touchmove';

            bUP.addEventListener(eventStart, e => {
                e.preventDefault();
                bUP.classList.add('active');
                timer = setInterval(() => {
                    wrapPos.y += 0.02;
                    self.wrap.setAttribute('position', AFRAME.utils.coordinates.stringify(wrapPos));
                }, 10);
            })

            bUP.addEventListener(eventEnd, e => {
                e.preventDefault();
                bUP.classList.remove('active');
                clearInterval(timer);
            });

            bUP.addEventListener(eventLeave, e => {
                e.preventDefault();
                bUP.classList.remove('active');
                clearInterval(timer);
            });
            // ↑ 

            // ↓ DOWNボタン長押し
            bDOWN.addEventListener(eventStart, e => {
                e.preventDefault();
                bDOWN.classList.add('active');
                timer = setInterval(() => {
                    wrapPos.y -= 0.02;
                    self.wrap.setAttribute('position', AFRAME.utils.coordinates.stringify(wrapPos));
                }, 10);
            })

            bDOWN.addEventListener(eventEnd, e => {
                e.preventDefault();
                bDOWN.classList.remove('active');
                clearInterval(timer);
            });

            bUP.addEventListener(eventLeave, e => {
                e.preventDefault();
                bUP.classList.remove('active');
                clearInterval(timer);
            });
            // ↑ 
        </script>-->

<!--        <script>
            var nft = document.getElementById("ar-gltf");
            var anglebtn = document.querySelector('#swAngle');
            var parallelbtn = document.querySelector('#swParallel');
            var arRotation = '-45 0 0';

            anglebtn.classList.add('current');

            anglebtn.addEventListener('click', function () {
                if (!anglebtn.classList.contains('current')) {
                    arRotation = '-30 0 0';
                    nft.setAttribute('rotation', AFRAME.utils.coordinates.stringify(arRotation));

                    anglebtn.classList.add('current');
                    parallelbtn.classList.remove('current');
                }
            });

            parallelbtn.addEventListener('click', function () {
                if (!parallelbtn.classList.contains('current')) {
                    arRotation = '-95 0 0';
                    nft.setAttribute('rotation', AFRAME.utils.coordinates.stringify(arRotation));

                    parallelbtn.classList.add('current');
                    anglebtn.classList.remove('current');
                }
            });

        </script>-->

        <script type="text/javascript" src="js/nft-view.main.js"></script>

    </body>

</html>
